[2022-05-30 16:53:44,391] ERROR Error while reading checkpoint file /tmp/kafka-logs-2/cleaner-offset-checkpoint (kafka.server.LogDirFailureChannel)
java.nio.file.NoSuchFileException: /tmp/kafka-logs-2/cleaner-offset-checkpoint
	at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)
	at java.base/sun.nio.fs.UnixFileSystemProvider.newByteChannel(UnixFileSystemProvider.java:219)
	at java.base/java.nio.file.Files.newByteChannel(Files.java:375)
	at java.base/java.nio.file.Files.newByteChannel(Files.java:426)
	at java.base/java.nio.file.spi.FileSystemProvider.newInputStream(FileSystemProvider.java:420)
	at java.base/java.nio.file.Files.newInputStream(Files.java:160)
	at java.base/java.nio.file.Files.newBufferedReader(Files.java:2916)
	at java.base/java.nio.file.Files.newBufferedReader(Files.java:2948)
	at org.apache.kafka.server.common.CheckpointFile.read(CheckpointFile.java:104)
	at kafka.server.checkpoints.CheckpointFileWithFailureHandler.read(CheckpointFileWithFailureHandler.scala:48)
	at kafka.server.checkpoints.OffsetCheckpointFile.read(OffsetCheckpointFile.scala:70)
	at kafka.log.LogCleanerManager.$anonfun$allCleanerCheckpoints$2(LogCleanerManager.scala:136)
	at scala.collection.Iterator$$anon$10.nextCur(Iterator.scala:585)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:599)
	at scala.collection.immutable.List.prependedAll(List.scala:152)
	at scala.collection.immutable.List$.from(List.scala:684)
	at scala.collection.immutable.List$.from(List.scala:681)
	at scala.collection.IterableFactory$Delegate.from(Factory.scala:288)
	at scala.collection.immutable.Iterable$.from(Iterable.scala:35)
	at scala.collection.immutable.Iterable$.from(Iterable.scala:32)
	at scala.collection.IterableFactory$Delegate.from(Factory.scala:288)
	at scala.collection.IterableOps.flatMap(Iterable.scala:673)
	at scala.collection.IterableOps.flatMap$(Iterable.scala:673)
	at scala.collection.AbstractIterable.flatMap(Iterable.scala:919)
	at kafka.log.LogCleanerManager.$anonfun$allCleanerCheckpoints$1(LogCleanerManager.scala:134)
	at kafka.log.LogCleanerManager.allCleanerCheckpoints(LogCleanerManager.scala:142)
	at kafka.log.LogCleanerManager.$anonfun$grabFilthiestCompactedLog$1(LogCleanerManager.scala:173)
	at kafka.log.LogCleanerManager.grabFilthiestCompactedLog(LogCleanerManager.scala:170)
	at kafka.log.LogCleaner$CleanerThread.cleanFilthiestLog(LogCleaner.scala:349)
	at kafka.log.LogCleaner$CleanerThread.tryCleanFilthiestLog(LogCleaner.scala:336)
	at kafka.log.LogCleaner$CleanerThread.doWork(LogCleaner.scala:323)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2022-05-30 16:53:44,411] WARN [ReplicaManager broker=2] Stopping serving replicas in dir /tmp/kafka-logs-2 (kafka.server.ReplicaManager)
[2022-05-30 16:53:44,414] INFO [ReplicaFetcherManager on broker 2] Removed fetcher for partitions HashSet(__consumer_offsets-22, __consumer_offsets-30, __consumer_offsets-46, __consumer_offsets-36, __consumer_offsets-24, __consumer_offsets-38, __consumer_offsets-48, __consumer_offsets-12, __consumer_offsets-26, __consumer_offsets-34, __consumer_offsets-8, __consumer_offsets-4, __consumer_offsets-16, __consumer_offsets-28, __consumer_offsets-42, __consumer_offsets-18, __consumer_offsets-2, __consumer_offsets-6, __consumer_offsets-14, __consumer_offsets-20, __consumer_offsets-0, __consumer_offsets-44, __consumer_offsets-10, __consumer_offsets-32, __consumer_offsets-40) (kafka.server.ReplicaFetcherManager)
[2022-05-30 16:53:44,415] INFO [ReplicaAlterLogDirsManager on broker 2] Removed fetcher for partitions HashSet(__consumer_offsets-22, __consumer_offsets-30, __consumer_offsets-46, __consumer_offsets-36, __consumer_offsets-24, __consumer_offsets-38, __consumer_offsets-48, __consumer_offsets-12, __consumer_offsets-26, __consumer_offsets-34, __consumer_offsets-8, __consumer_offsets-4, __consumer_offsets-16, __consumer_offsets-28, __consumer_offsets-42, __consumer_offsets-18, __consumer_offsets-2, __consumer_offsets-6, __consumer_offsets-14, __consumer_offsets-20, __consumer_offsets-0, __consumer_offsets-44, __consumer_offsets-10, __consumer_offsets-32, __consumer_offsets-40) (kafka.server.ReplicaAlterLogDirsManager)
[2022-05-30 16:53:44,436] WARN [ReplicaManager broker=2] Broker 2 stopped fetcher for partitions __consumer_offsets-22,__consumer_offsets-30,__consumer_offsets-46,__consumer_offsets-36,__consumer_offsets-24,__consumer_offsets-38,__consumer_offsets-48,__consumer_offsets-12,__consumer_offsets-26,__consumer_offsets-34,__consumer_offsets-8,__consumer_offsets-4,__consumer_offsets-16,__consumer_offsets-28,__consumer_offsets-42,__consumer_offsets-18,__consumer_offsets-2,__consumer_offsets-6,__consumer_offsets-14,__consumer_offsets-20,__consumer_offsets-0,__consumer_offsets-44,__consumer_offsets-10,__consumer_offsets-32,__consumer_offsets-40 and stopped moving logs for partitions  because they are in the failed log directory /tmp/kafka-logs-2. (kafka.server.ReplicaManager)
[2022-05-30 16:53:44,437] WARN Stopping serving logs in dir /tmp/kafka-logs-2 (kafka.log.LogManager)
[2022-05-30 16:53:44,444] ERROR Shutdown broker because all log dirs in /tmp/kafka-logs-2 have failed (kafka.log.LogManager)
